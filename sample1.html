<!DOCTYPE html>
<html lang="en-US">
 
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Rulik WebSamples</title>
</head>

<body>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>
        var browser = "Uknown";
        if(navigator.userAgent.indexOf("Chrome") != -1 ){
            browser = "Chrome";
        } else if(navigator.userAgent.indexOf("Safari") != -1) {
            browser = "Safari";
        }

        if(browser.localeCompare("Safari") == 0){
            //document.body.requestFullscreen();
        } else {
            document.body.requestFullscreen();
            screen.orientation.lock("portrait");
        }

        document.body.style.height="100vh";
        document.body.style.width="100vw";
        document.body.style.margin=0;
        document.body.style.display="block";
                                
        var canvas = document.createElement("Canvas");
        canvas.width  = document.body.clientWidth;
        canvas.height = document.body.clientHeight;
        canvas.style.display = "flex";
        canvas.style.background = "#909090";     
        
        var ctx = canvas.getContext("2d");
        ctx.font = "16px Arial";
        //ctx.font = "16px Comic Sans MS";
        ctx.fillStyle = "Lime";
        ctx.fillText(browser, 10, 30);
        
        ctx.rect(canvas.width/2, canvas.height/2, 10, 10);
        ctx.fillStyle = "blue";
        ctx.fill();
        document.body.appendChild(canvas);
        
        let btn = document.createElement("Button");
        btn.style.position = "absolute";
        btn.style.left = document.body.clientWidth / 2 - 100 + "px";
        btn.style.top = "150px";
        btn.style.width = "200px";
        btn.style.height = 100  + "px";
        btn.style.background = 'DeepSkyBlue';
        btn.style.color = 'white';
        btn.style.fontSize = '24px'
        btn.style.borderRadius = "10px"
        btn.style.visibility = 'hidden'
        btn.addEventListener("click", getAccelerometerPermissions);
        btn.innerHTML = "Get Accelerometer Permissions";
        document.body.appendChild(btn);

        var lbl = document.createElement("Label");
        lbl.style.position = "absolute";
        let lbl_width = document.body.clientWidth * 0.8;
        lbl.style.width = document.body.clientWidth * 0.8 + "px";
        lbl.style.left = document.body.clientWidth/2 - lbl_width/2  + "px";
        lbl.style.top = 50 + "px";        
        lbl.style.height = 50  + "px";        
        lbl.style.fontSize = '24px'
        lbl.innerHTML = "Here goes the text";
        document.body.appendChild(lbl);

        const rotateDegrees = 1; // alpha: rotation around z-axis
        const leftToRight = 2; // gamma: left to right
        const frontToBack = 3; // beta: front back motion
        lbl.innerHTML = `${rotateDegrees} ${leftToRight} ${frontToBack}`

        function getAccelerometerPermissions(){
            if (window.DeviceOrientationEvent) {
                DeviceMotionEvent.requestPermission().then(response => {
                    if (response == 'granted') {
                        lbl.innerHTML = "Orientation is availanle";
                        window.addEventListener("deviceorientation", (event) => {
                            const rotateDegrees = event.alpha; // alpha: rotation around z-axis
                            const leftToRight = event.gamma; // gamma: left to right
                            const frontToBack = event.beta; // beta: front back motion
                            handleOrientationEvent(frontToBack, leftToRight, rotateDegrees);
                        }, true);
                    }
                });
            } else {
                lbl.innerHTML = "Orientation not availanle";
            }
        }

        const handleOrientationEvent = (frontToBack, leftToRight, rotateDegrees) => {
            frontToBack = frontToBack.toFixed(2);
            leftToRight = leftToRight.toFixed(2);
            rotateDegrees = rotateDegrees.toFixed(2);
            lbl.innerHTML = `${rotateDegrees} ${leftToRight} ${frontToBack}`
        };

        handleOrientationEvent(0.12344, 0.1244, 0.83264284);

        if(browser.localeCompare("Safari") == 0){
            btn.style.visibility = 'visible';

        } else {
            if (window.DeviceOrientationEvent) {
                window.addEventListener("deviceorientation", (event) => {
                    const rotateDegrees = event.alpha; // alpha: rotation around z-axis
                    const leftToRight = event.gamma; // gamma: left to right
                    const frontToBack = event.beta; // beta: front back motion
                    handleOrientationEvent(frontToBack, leftToRight, rotateDegrees);
                    }, true);                    
            } else {
                lbl.innerHTML = "Orientation not availanle";                
            }
        }
    </script>
</body>
</html>
